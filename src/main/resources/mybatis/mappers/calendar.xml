<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="calendar">
	<select id="findAll" parameterType="long" resultType="calendarvo">
		<![CDATA[
			select a.name as 'userName', b.no as 'id', b.title, b.start_date as 'start', b.end_date as 'end'
				from user a, card b, card_member c, (select p.no as "projctNo", pm.user_no as "userNo" from project p, proj_member pm where pm.user_no = #{userNo } group by p.no) ppm
				    where a.no = c.user_no
				    and b.no = c.card_no
                    and ppm.userNo = #{userNo }
				    group by b.no;
		]]>
	</select>
	<select id="findByNo" parameterType="long" resultType="calendarvo" >
		<![CDATA[
			select a.name as 'userName', b.no as 'id', b.title, b.start_date as 'start', b.end_date as 'end'
				from user a, card b, card_member c
				    where a.no = c.user_no
				    and b.no = c.card_no
				    and a.no = #{userNo }
				    group by b.no;
		]]>
	</select>
</mapper>
